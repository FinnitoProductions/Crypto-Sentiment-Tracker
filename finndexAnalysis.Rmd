---
title: "Finndex: Forecasting and Validating Cryptocurrency Price Using Fundamental Blockchain Factors"
author: "Finn Frankis"
date: "11/25/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse", repos = "http://cran.us.r-project.org")
install.packages("psych", repos = "http://cran.us.r-project.org")
install.packages("leaps", repos = "http://cran.us.r-project.org")

library(tidyverse)
library(leaps)
library(psych)
```
# Multiple Regression
## Data Import
First, we import our data.
```{r}
# Read in data
data_agg <- read.csv("aggregate.csv")
```

## Predictor-Response Interactions
```{r interaction}
# A fancy scatterplot matrix with pearson method of correlation
pairs.panels(data_agg[c("PriceUSD","BlkCnt","TxCnt","AdrActCnt","Trends","FearGreed")], 
             method = "pearson", hist.col = "#00AFBB", # color of histogram
smooth = FALSE, density = FALSE, ellipses = FALSE)
```
\newline We study the scatterplot matrix to investigate potential multicollinearity issues between predictors and to determine which predictors are most strongly correlated with our response value of price. It seems that the block count and trends predictors both have very weak correlations with price, so we might consider eliminating them from our model. With regards to multicollinearity, block count and transaction count are moderately correlated in a positive direction, as are transaction count and address count and address count and fear and greed. If our model has a high VIF, and particularly if we add interaction terms, we may consider centering predictors or removing the predictors which are strongly correlated with one another to reduce multicollinearity. The correlation matrices do not indicate any strong non-linear patterns (all the weak correlations are caused by slope = 0, not by a non-linerr pattern), so we likely do not need to rely on a more advanced polynomial regression model.

## Model-Building
We employ the best subsets regression model-building strategy.
```{r subsets}
# Find the best model for each number of predictors (with 5 predictors maximum)
models <- regsubsets(PriceUSD~BlkCnt+TxCnt+AdrActCnt+Trends+FearGreed, data_agg, nvmax = 5) 
models.sum <- summary(models)
# Create four plots within a 2x2 frame to compare the different criteria
par(mfrow = c(2,2)) 
# SSE
plot(models.sum$rss, xlab = "Number of predictors", ylab = "SSE", type = "l ")
# R2
plot(models.sum$adjr2, xlab = "Number of predictors", ylab = "Adjusted RSq" , type = "l")
# Mallow's Cp
plot(models.sum$cp, xlab = "Number of predictors", ylab = "Cp", type = "l") 
# BIC
plot(models.sum$bic, xlab = "Number of predictors", ylab = "BIC", type = "l
")
```
These plots clearly reveal to us that 3 predictors is optimal: this is where Mallow's Cp and the BIC result in a local minimum, and this is where the adjusted $R^2$ has a local maximum. Additionally, the SSE does not decrease by a significant amount for more than 3 predictors. Now, we must determine which 3 predictors would be optimal. 
```{r bestPreds}
# Display the best model (selected predictors are indicated by *) for each number of predictors
models.sum$outmat
```
This indicates to us that our best model with 3 predictors uses transaction count, address count, and fear and greed, which supports our speculation in the scatterplot matrices. We perform a regression using these three values below.

```{r}
reg_mult <- lm(PriceUSD~TxCnt+AdrActCnt+FearGreed, data_agg)
summary(reg_mult)
```
